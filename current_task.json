{
  "task": "fix_concept_map_tool_not_diagrams",
  "version": "1.0.0",
  "project": "Maestro",
  "critical_instruction": "FIX THE TOOL, NOT THE GENERATED DIAGRAMS",
  "maestro_url": "http://localhost:4004/concepts",
  "status": "ready",
  
  "CRITICAL_UNDERSTANDING": {
    "DO_NOT": [
      "Edit CONCEPT_DAG.dot files manually",
      "Edit generated SVG files",
      "Fix the diagrams directly",
      "Modify the output"
    ],
    "DO": [
      "Fix the code in concepts_live.ex that generates the diagrams",
      "Fix the maestro_tool that creates the DOT files",
      "Fix the generation logic",
      "Fix the tool, not its output"
    ]
  },
  
  "the_problem": {
    "what": "The generate_directory_dag function in concepts_live.ex has bugs",
    "where": "lib/maestro_web/live/concepts_live.ex - generate_directory_dag/2 and generate_session_relationships/1",
    "issue_1": "generate_session_relationships returns wrong format or empty string",
    "issue_2": "Variable warnings indicate logic errors in the generation code",
    "issue_3": "Sub-DAG generation runs on every page view (inefficient)"
  },
  
  "what_to_fix": {
    "file": "lib/maestro_web/live/concepts_live.ex",
    "function_1": "generate_session_relationships/1 - Fix the relationships variable and logic",
    "function_2": "generate_directory_dag/2 - Make sure it generates valid DOT syntax",
    "function_3": "Consider caching the generated SVGs instead of regenerating on every view"
  },
  
  "how_to_test": {
    "step_1": "Navigate to /concepts/sessions",
    "step_2": "Check if the sub-DAG shows files with connections between them",
    "step_3": "Look for arrows between chronologically related session files",
    "step_4": "Click on a file node to verify navigation works"
  },
  
  "current_warnings": [
    "variable 'relationships' is unused (there is a variable with the same name in the context)",
    "variable 'task_summaries' is unused",
    "These indicate bugs in generate_session_relationships/1"
  ],
  
  "expected_behavior": {
    "sessions_view": "Should show all session files connected chronologically",
    "example": "SESSION_LEARNINGS_2025_10_28_session2.md â†’ SESSION_LEARNINGS_2025_10_29_session3.md",
    "relationships": "Arrows showing 'followed by' between sequential sessions"
  },
  
  "tools_you_have": {
    "read_code": "Read concepts_live.ex to understand current implementation",
    "fix_code": "Edit concepts_live.ex to fix the generation logic",
    "test": "Navigate to /concepts/sessions to see if your fix worked",
    "reference": "Look at how the main concept_dag is generated for patterns"
  },
  
  "remember": "You are a developer fixing a bug in the diagram generation code. You do NOT edit the diagrams themselves. You edit the CODE that generates the diagrams."
}
